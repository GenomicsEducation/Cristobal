# Título: Práctica elaboración de un proyecto de genómica aplicada.
## Autor: Cristóbal Domínguez, Ecuador, Biólogo Marino.
### Descripción: Proyecto_genomica_Penaeus vannamei
### <https://www.ncbi.nlm.nih.gov/assembly/?term=Penaeus+vannamei
**Assembly_ASM378908v1**
## Organism: ***Penaeus vannamei*** (Pacific white shrimp)
### Infraspecific name: Breed: Kehai No.1
### Sex: male
### Submitter: Institute of Oceanology, Chinese Academy of Sciences
### Date: 2018/11/16
### Assembly level: Scaffold
### Genome representation: full
### RefSeq category: representative genome
### GenBank assembly accession: GCA_003789085.1 (latest)
### RefSeq assembly accession: GCF_003789085.1 (latest)
### IDs: 2106361 [UID] 7871408 [GenBank] 8054448 [RefSeq]
### SRX10866775: 16S rRNA of gut microbiota
### 1 ILLUMINA (Illumina NovaSeq 6000) run: 133,094 spots, 64.9M bases, 23.2Mb downloads
### WGS Project: QCYY01Assembly 
### method: WTDBG v. 1.2Expected final version: yes
### Genome coverage: 84.0x
### Sequencing technology: PacBio; Illumina HiSeq
### IDs: 2106361 [UID] 7871408 [GenBank] 8054448 [RefSeq]

## Global statistics
|Columna 1|Columna 2|
|---------|---------|
|Total sequence length| 1,663,581,301|
|Total ungapped length|	1,618,053,608|
|Gaps between scaffolds|	0|
|Number of scaffolds|	4,683|
|Scaffold N50|	605,555|
|Scaffold L50|	892|
|Number of contigs|	33,020|
|Contig N50|	86,864|
|Contig L50|	5,435|
|Total number of chromosomes and plasmids|	1|
|Number of component sequences (WGS or clone)|	4,683|

# BIOPROYECTO
### <https://www.ncbi.nlm.nih.gov/sra?term=SRP319658
## SRX10866775: 16S rRNA of gut microbiota
### 1 ILLUMINA (Illumina NovaSeq 6000) run: 133,094 spots, 64.9M bases, 23.2Mb downloads
### Submitted by: Guangdong Ocean University
### Study: Pacific white shrimp 16S rDNA
### PRJNA729583 • SRP319658 • All experiments • All runs
### Sample: SAMN19136062 • SRS8961620 • All experiments • All runs
### Source: GENOMIC
### Selection: PCR
### Layout: PAIRED 

## Runs: 1 run, 133,094 spots, 64.9M bases, 23.2Mb
|Columna 1|Columna 2|Columna 3|Columna 4|Columna 5|
|---------|---------|---------|---------|---------|
|Run|	# of Spots|	# of Bases|	Size	Published|
|SRR14521329|	133,094| 64.9M|	23.2Mb|	2021-05-15|

## **Numero de muestra del Bioproyecto_PRJNA729583**
### <https://www.ncbi.nlm.nih.gov/sra/SRX10866775[accn]
1. 16S rRNA of gut microbiota: (Illumina NovaSeq 6000) run: 133,094 spots, 64.9M bases, 23.2Mb downloads Accession: SRX10866775
2. 16S rRNA of gut microbiota: (Illumina NovaSeq 6000) run: 120,032 spots, 58.6M bases, 21.1Mb downloads Accession: SRX10866774
3. 16S rRNA of gut microbiota: (Illumina NovaSeq 6000) run: 135,905 spots, 66.3M bases, 24Mb downloads Accession: SRX10866773
4. 16S rRNA of gut microbiota: (Illumina NovaSeq 6000) run: 132,358 spots, 64.6M bases, 23.1Mb downloads Accession: SRX10866772
5. 16S rRNA of gut microbiota: (Illumina NovaSeq 6000) run: 125,539 spots, 61.3M bases, 21.9Mb downloads Accession: SRX10866771
6. 16S rRNA of gut microbiota: (Illumina NovaSeq 6000) run: 126,824 spots, 61.9M bases, 22.1Mb downloads Accession: SRX10866770
7. 16S rRNA of gut microbiota: (Illumina NovaSeq 6000) run: 130,716 spots, 63.8M bases, 22.7Mb downloads Accession: SRX10866769
8. 16S rRNA of gut microbiota: (Illumina NovaSeq 6000) run: 124,443 spots, 60.7M bases, 21.8Mb downloads Accession: SRX10866768
9. 16S rRNA of gut microbiota: (Illumina NovaSeq 6000) run: 126,887 spots, 61.9M bases, 22.4Mb downloads Accession: SRX10866767

# Metadata
[SraRunTable.txt](https://github.com/GenomicsEducation/Cristobal/files/6663430/SraRunTable.txt)

# Clonar repositorio a PC
![Clonar_proyecto](https://user-images.githubusercontent.com/84527758/125744239-aeda0f4e-b73d-4945-8af2-0ad0b3554c03.jpg)
## proyecto repositorio Github_Rstudio
![Proyecto_git_Rstudio](https://user-images.githubusercontent.com/84527758/125744304-323664d1-6ef1-48ff-9cfd-bf53dd13e3c1.jpg)
  
  
# Práctica_9_introducción a Linux para genomica 
**Instalación y configuración de software**
### Ventajas de usar Shell: conectividad y acceso remoto: El uso de Shell facilita la conectividad y el acceso remoto a recursos computacionales desde cualquier parte del mundo.
-PuTTy
Link de descarga <https://www.putty.org/  
-WinSCP
LinK de descarga <https://winscp.net/eng/download.php    

**Práctica de Shell y Linux**
## Acceso remoto a servidor POMEO mediante puTTy
![Putty_](https://user-images.githubusercontent.com/84527758/125745896-699ca110-c473-4bd2-ba4d-5df3ead3978b.jpg)  

## Conectar a pomeo 
![Conectar_pomeo](https://user-images.githubusercontent.com/84527758/125746007-0156110f-6692-4046-91c7-869b9c14f789.png)  

**Instalación y configuración software**
## Miniconda3
Link: https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh bash Miniconda3-latest-Linux-x86_64.sh  

### Instalación de conda
![Instalación de conda](https://user-images.githubusercontent.com/84527758/125747077-65d542f0-b22e-499c-91cc-03a8c68c6e94.jpg)  

### Configuración de conda 
![configuración_conda](https://user-images.githubusercontent.com/84527758/125747317-81ccb096-a298-4ead-b1c0-9671ee9594b4.jpg)  

## Exploración de paquetes instalados
![Revisión de paquetes instalado_miniconda](https://user-images.githubusercontent.com/84527758/125750602-a2f6428f-9dfd-4a75-8eeb-052e0deca409.jpg)  

## Creación de script con nano
![creación de cript](https://user-images.githubusercontent.com/84527758/125747612-0e8cb0f3-f659-4f33-a72a-10b112b11bdb.jpg)  

## Instalación de SRA Toolkit  
![Instalar_sratoolkit](https://user-images.githubusercontent.com/84527758/125747863-3d063ed3-3e1a-487a-8d55-a7c25ebab148.jpg)  

## Exploración de paquetes instalados
![Revisión de paquetes instalado2](https://user images.githubusercontent.com/84527758/125750653-3f730080-fe79-4648-8625-e8c151c57c1c.jpg)  

**Descarga de secuencias NGS comprimidas en formato SRA
Script: # !/bin/bash
# Descarga y descomprime SRA Toolkit
wget: http://ftp-trace.ncbi.nlm.nih.gov/sra/sdk/current/sratoolkit.current centos_linux64.tar.gz tar -xzf sratoolkit.current-centos_linux64.tar.gz  

**Configuración de sratoolkit
![SRA_configuación](https://user-images.githubusercontent.com/84527758/125748746-be00181d-629f-4d31-9c3f-d4b2428c241f.jpg)    

**Descarga de las 5 primeras secuencias 
![Mostrar las 5 primera secuencias](https://user-images.githubusercontent.com/84527758/125749145-af380fd1-0949-4a59-bba5-cca09d2eb163.jpg)  

**Descarga de la biomuetra completa
![Descargar la Biomuestra completa](https://user-images.githubusercontent.com/84527758/125749293-68471d0a-8fc3-403c-a7cd-1d156e043e0b.jpg)  

## Lista de comandos
-Nombre del directorio en el que se encuentra  
`pwd`  
-Espacio total en el sistema, espacio usado, espacio disponible  
`df -hP`  
-Evalua el performance de la CPU, similar al monitor del sistema  
`top`  
-Crea un directorio de trabajo denominado tesis  
`mkdir tesis`  
-Cambia al directorio tesis  
`cd tesis`  
-Para volver al directorio anterior  
`cd`  
-Al usar el simbolo > que funciona como una tubería la información del espacio total del sistema se almacena en un documento de texto denominado espacio_libre_pomeo.txt  
`df -hP > espacio_libre_pomeo.txt`  
-Leer datos de un archivo e imprimir su contenido en la terminal  
`cat espacio_libre.txt`  
-Leer datos de un archivo sin imprimir en la terminal y recorrerlo  
`less espacio_libre.txt`  
-Contar líneas, palabras y caracteres de un fichero  
`wc espacio_libre.txt`  
-Listado de objetos en un directorio  
`ls`  
-Información con mas detalle de los objetos y de un tamaño que sea legible por humanos  
`ls -l -h`  
-Remover un fichero o directorio forzando la acción  
`rm tesis  
rm -r tesis`  
-Moverse por las líneas ejecutadas en la terminal  
`flecha arriba/abajo`  
-Imprimir todas las líneas de comando ejecutadas en la terminal  
`history`  
-Autocompletar nombres de ficheros  
`tecla tab`  
-Mover el cursor al comienzo de la línea actual   
`ctrl-a`  
-Mover el cursor al final de la línea actual  
`ctrl-e`  
-Borrar desde el cursor hasta el final de la línea   
`ctrl-k`  
-Borrar desde el cursor hasta el inicio de la línea  
`ctrl-u`  
-Borrar la palabra inmediatamente detras del cursor  
`ctrl-w`  
-Cerrar la sesión  
`exit`    
    
# Practica_10 y 11_Analisis de secuenciación y control de calidad, filtrado y poda
## Objetivo: 
1. Realizar un análisis integral de control de calidad de secuencias NGS con fastqc
2. Filtrar y podar las secuencias con el software trimmomatic
3. Realizar el alineamiento de una muestra en formato .fastq a un genoma de referencia  
4. 
### Actividades 
-Conectar con el servidor POMEO
![Putty_](https://user-images.githubusercontent.com/84527758/125758630-682f4194-9fe2-4a7d-b1dd-915464933981.jpg)  

### instalación y configuración software

**Bioconda  

|Acción|Comando|
|---------|---------|
|Configurar|conda config --add channels bioconda|
|buscar software en bioconda|conda search -c bioconda fast-qc , conda search -c bioconda fastqc , conda search -c bioconda trimmomatic|
|Instalar|conda install -c bioconda fastqc, conda install -c bioconda trimmomatic|

![Configurar_bioconda](https://user-images.githubusercontent.com/84527758/125762234-140067e2-8a8a-45fe-bb1c-382a3fce9729.jpg)

![Instalar_bioconda](https://user-images.githubusercontent.com/84527758/125762168-a940cb2b-12e7-44c0-892a-f37c8a886a4c.jpg)

![Instalar_bioconda_trimmomatic](https://user-images.githubusercontent.com/84527758/125762307-6cabe391-e14f-4766-a070-6a0292dae379.jpg)

**Crear directorio SRA_samples

![Creación de directorio_SRA samples](https://user-images.githubusercontent.com/84527758/125762494-872ac0c8-3a4a-4cde-b0ad-a1cbeafda880.jpg)  

**Crear un script   

![Creación de script_nano_SRA samples__](https://user-images.githubusercontent.com/84527758/125763316-f93ae60a-2a2f-476b-a319-5ce197adaf62.jpg)


# Practica_12
### Objetivo


# Practica_13
### Objetivo
-Realizar un analisis de genomica poblacional y ancestria en Salmo salar a partir de archivo de variantes VCF  
### Actividades:  
**Conectar al servidor POMEO  
![Putty_p13](https://user-images.githubusercontent.com/84527758/125852845-8bf6b019-eccb-467e-8a0e-ef921f31f52e.jpg)

**Configurar bioconda  
`conda config --add channels bioconda`   

**Instalar los software plink  
`cconda install -c bioconda plink`  

## Instalar admixture  
`conda install -c bioconda admixture`
![Instalar_bioconda_plink](https://user-images.githubusercontent.com/84527758/125855463-0bf3ff17-a713-449d-92c9-1d63a68a0917.jpg)

## Crear direcotio de trabajo "population"
`cd population` 
`ls -l -h`  
![Chequeo de datos](https://user-images.githubusercontent.com/84527758/125871329-7b85eca3-3ad8-4ecc-9ded-f0e359af8711.jpg)

## Analsis de diversidad
`vcftools --vcf EU_OC_US.vcf --het --out EU_OC_US`  
`vcftools --vcf EU_OC_US.vcf --hardy --out EU_OC_US`  

## Calcular la diversidad en una ventana no superpuesta de 200 kb para cada individuo de las tres poblaciones  

### Para la poblacion de Europa
`vcftools --vcf EU_OC_US.vcf --window-pi 200000 --indv 2_WG0341511-DNA_A02_5408 --indv 3_WG0341511-DNA_A03_5416 --indv 5_WG0341511-DNA_A05_5450 --out EU`  

## Para la poblacion de Oceania
`vcftools --vcf EU_OC_US.vcf --window-pi 200000 --indv FR07958834 --indv FR07958842 --indv FR07958850 --out OC`

## Para la poblacion de Norteamerica
`vcftools --vcf EU_OC_US.vcf --window-pi 200000 --indv GNB12-1 --indv GNB12-10 --indv GNB12-11 --out US`

![Analisis_diversidad](https://user-images.githubusercontent.com/84527758/125871406-7875c8ed-547d-4c1b-8dd2-29c35824c655.jpg)
![Analisis_diversidad_EU_OC](https://user-images.githubusercontent.com/84527758/125871409-67e394a1-6234-4352-884d-496f58c2625f.jpg)
![Analisis_diversidad_US](https://user-images.githubusercontent.com/84527758/125871410-954e6b24-1ffe-4a4c-a281-3ad190b4675d.jpg)

## Calcular el desequilibrio de ligamiento (LD) para las tres poblaciones

**Población de Europa
`vcftools --vcf EU_OC_US.vcf --geno-r2 --chr 1 --ld-window-bp 100000 --min-r2 0.001 --indv 2_WG0341511-DNA_A02_5408 --indv 3_WG0341511-DNA_A03_5416 --indv 5_WG0341511-DNA_A05_5450 --out EU`

**Población Oceania
`vcftools --vcf EU_OC_US.vcf --geno-r2 --chr 1 --ld-window-bp 100000 --min-r2 0.001 --indv FR07958834 --indv FR07958842 --indv FR07958850 --out OC`

**Poblacion de Norteamerica
`vcftools --vcf EU_OC_US.vcf --geno-r2 --chr 1 --ld-window-bp 100000 --min-r2 0.001 --indv GNB12-1 --indv GNB12-10 --indv GNB12-11 --out US`

![Deshequilibrio_](https://user-images.githubusercontent.com/84527758/125881111-e9e466bf-ffcb-4bc5-b320-9b855326952e.jpg)


# Practica_14_Introduccion a los estudios de asociación genómica  

### Objetivo  

-Realizar un análisis de asociación genómico usando datos simulados de genotipos y fenotipos  

### Conectar a proyecto Rstudio.cloud  

![Ingreso_proyecto_Rstudio_Cloud](https://user-images.githubusercontent.com/84527758/125776010-b5dbc4ba-1989-4151-8c2a-fb52b798d75f.jpg)

### Detalles de la practica en Rstudio.cloud

**Importa datos geno y pheno
-geno <- read.delim("geno.txt", sep = "\t", dec = ",", header = T)  
-pheno <- read.delim("pheno.txt", sep = "\t", dec = ",", header = T)  


### ¿Cómo están codificados los genotipos de cada SNP?
-Los genotipos están codificados como (-1, 0 y 1). Dónde (-1, 0 y 1) hace referencia al homocigoto del alelo menor, heterocigoto, homocigoto del alelo mayor, respectivamente.

### ¿Observa heterocigotos?
-Si se evidencia heterocigotos en los tres individuos analizados. Sin embargo, el individuo 2 es el organismo con mayor heterocigotos

### Elaboración de histograma
`head(pheno)`  
`hist(pheno$y)`  

**Figura_histograma_fenotipo
![histograma_feno](https://user-images.githubusercontent.com/84527758/125791820-a19595b3-96dd-47dc-a947-317cdbffb410.jpg)

**Figura_histograma_A
![histograma_A](https://user-images.githubusercontent.com/84527758/125792123-83913d5a-25fb-4ddb-82e6-ab8cac2cc360.jpg)

**Figura_histograma de endogamia
`endogamia <- diag(A)`  
`hist(endogamia, main = "Histograma de endogamia")`    

![histograma_geno](https://user-images.githubusercontent.com/84527758/125792204-6792f384-5955-49e1-a6d3-c582ef4079d2.jpg)

**Efecto de los QTLs detectados por el GWAS  
`score <- GWAS(pheno,geno, plot=TRUE)`

![Cromosoma](https://user-images.githubusercontent.com/84527758/125793686-747240fb-a9a7-431f-a9e8-8042b72df8a2.jpg)

### ¿Cuál es el nivel de endogamia promedio de esta población?  
-El nivel de endogamia promedio de esta población es de (1), debido a que claramente ilustra el histograma que los valores fluctúan aproximadamente de 0.75 a 1.25

### ¿Que significa un valor de endogamia de 1.1?  
-El valor de (1.1) nos indica una mayor probabilidad del (10%) de incremento de endogamia en la población respecto al promedio de la población.  

### ¿Que representa un valor de endogamia de 0.90?  
El valor de (0.9) nos indica una menor probabilidad del (10%) en reducir la endogamia en la población respecto al promedio de la población.  

## Visualmente: ¿Cuantos QTLs fueron detectados por el análisis GWAS? ¿En qué cromosomas se encuentran?  
Visualmente se observan varios QTLs. Sin embargo solo dos fueron muy marcado, que sobrepasan la linea punteada, uno en el cromosoma 3 y otro en el cromosoma 10.

**Gráfico de regresión lineal  
`t_geno_300 <- t(geno[300,4:203])+1`  
`t_geno_1000 <- t(geno[1000,4:203])+1`  
`qtl <- data.frame(t_geno_300,t_geno_1000,pheno$y)`  
`qtl.1 <- ggplot(qtl, aes(x = X300, y = pheno.y))`  
`qtl.1 + geom_point() + xlab("snp 300") +  ylab("Pheno")+ geom_smooth(method=lm)`  
`geom_smooth()` using formula 'y ~ x'  

### ¿Qué SNP fueron significativos?  
-Se identificaron dos QTLs significativos (snp300) y (snp1000), tal como se visualizó en el gráfico obtenido en el análisis GWAS.

** Grafico de regresión   

![snp_300](https://user-images.githubusercontent.com/84527758/125792847-89b1148b-d885-4f4c-8e2d-7c432a41316f.jpg)

`qtl.2 <- ggplot(qtl, aes(x = X1000, y = pheno.y))`  
`qtl.2 + geom_point() + xlab("snp 1000") +  ylab("Pheno")+ geom_smooth(method=lm)`    
 `geom_smooth()` using formula 'y ~ x'  

** Grafico de regresión
![nsp_1000](https://user-images.githubusercontent.com/84527758/125792796-ef47a26b-0bd4-4dee-b1e0-a093a92bfdb0.jpg)


head(qtl)
**Practica completa_Documento pdf  

[Practica_14_CD.pdf](https://github.com/GenomicsEducation/Cristobal/files/6822769/Practica_14_CD.pdf)







